pipeline {
    agent any

    stages {
        stage('Run Tests') {
            steps {
                script {
                    def testResults = []

                    for (int i = 1; i <= 10; i++) {
                        // 替換以下指令為你的測試指令
                        def result = sh(script: "python --version", returnStatus: true)
                        
                        // 將結果存入列表
                        testResults.add(result ? 'success' : 'failure')
                    }

                    // 產生報告
                    def totalCycles = 10
                    def failCycles = testResults.count { it == 'failure' }
                    def passRate = (totalCycles - failCycles) * 100 / totalCycles

                    
                            subject: 'Test Results',
                            to: 'mayta51654944@gmail.com'
                }
            }
        }
    }
}
